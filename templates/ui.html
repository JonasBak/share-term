<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
  html {
    height: 100%;
    background-color: #262626;
  }
  body {
    display: flex;
    height: 100%;
    margin: 0px;
    justify-content: center;
    align-items: center;
  }
  #terminal {
    display: inline-block;
    box-shadow: 10px 8px #0009;
    border: 2px solid gray;
  }
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/xterm/3.14.5/xterm.css" integrity="sha256-RogLy8bOb4a5F5dhZEi0c6gSwYTUgD7h8rfGj9ogn0c=" crossorigin="anonymous" />
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xterm/3.14.5/xterm.min.js"></script>
<script type="text/javascript">
  window.addEventListener("load", evt => {
    const output = document.getElementById("output");
    const input = document.getElementById("input");
    const ws = new WebSocket("{{.}}");
    const term = new Terminal();

    term.open(document.getElementById('terminal'));

    ws.onopen = evt => {
    }
    ws.onclose = evt => {
    }
    ws.onmessage = evt => {
      const type = evt.data.substring(0,3);
      switch(type) {
        case "TXT":
          term.write(evt.data.substring(3));
          break;
        case "DIM":
          const [rows, cols] = evt.data.substring(3).split(",");
          term.resize(parseInt(cols), parseInt(rows));
          break;
        default:
          console.err("could not parse message: " + evt.data);
      }
    }
    ws.onerror = evt => {
      alert("ERROR: " + evt.data);
    }
  });
</script>
</head>
<body>
<div id="terminal"></div>
</body>
</html>
